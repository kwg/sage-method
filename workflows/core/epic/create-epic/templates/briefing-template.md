# {{epic_key}} Epic Briefing

**Generated:** {{date}}
**Epic:** {{epic_title}}
**Stories:** {{story_count}}

---

## Retrospective Learnings

### Learning Records from State Files

*Learning records extracted from epic state files (.sage/state/epic-*-state.json):*

| Source Epic | Type | Description | Applied To |
|-------------|------|-------------|------------|
{{#each state_file_learnings}}
| {{source_epic}} | {{type}} | {{description}} | {{applied_to_stories}} |
{{/each}}

{{#if no_state_file_learnings}}
*No state file learning records found. Using retrospective markdown only.*
{{/if}}

### Action Items to Address

*Unresolved action items from previous retrospectives that may affect this epic:*

| ID | Action | Source Epic | Status | Relevance to {{epic_key}} |
|----|--------|-------------|--------|---------------------------|
{{#each unresolved_action_items}}
| {{id}} | {{action}} | Epic {{source_epic}} | {{status}} | {{relevance}} |
{{/each}}

{{#if no_unresolved_items}}
*No unresolved action items affecting this epic.*
{{/if}}

### Key Lessons Learned

*Insights from previous epics that should inform {{epic_key}} execution:*

{{#each lessons}}
{{index}}. **{{title}}** (Epic {{source_epic}})
   {{description}}
   *Application:* {{how_to_apply}}

{{/each}}

### Process Improvements to Follow

*Workflow or process changes agreed in previous retros:*

{{#each process_improvements}}
- **{{name}}:** {{description}}
{{/each}}

---

## Applicable Patterns

### Technical Patterns

*Patterns from the patterns registry that MUST be applied in this epic:*

| Pattern ID | Name | Applies To | Reference |
|------------|------|------------|-----------|
{{#each technical_patterns}}
| {{id}} | {{name}} | {{applies_to}} | {{reference}} |
{{/each}}

### Pattern Details

{{#each technical_patterns}}
#### {{id}}: {{name}}

**When to use:** {{when_to_use}}

**Implementation:**
```
{{code_example}}
```

**Stories requiring this pattern:** {{story_list}}

{{/each}}

---

## Story Dependencies

### Dependency Graph

```
{{dependency_graph_ascii}}
```

### Execution Batches

{{#each batches}}
#### Batch {{batch_num}}: {{rationale}}

| Story | Title | Dependencies | Can Parallel |
|-------|-------|--------------|--------------|
{{#each stories}}
| {{key}} | {{title}} | {{dependencies}} | {{parallel}} |
{{/each}}

{{/each}}

---

## Technical Context

### Architecture References

*Relevant sections from architecture for this epic:*

{{#each architecture_sections}}
#### {{section_name}}

{{content_excerpt}}

*Relevant to stories:* {{story_list}}

{{/each}}

### Tech Spec References

*Relevant sections from tech specs for this epic:*

{{#each tech_spec_sections}}
#### {{section_name}} (from {{source_file}})

{{content_excerpt}}

{{/each}}

---

## Per-Story Context Injections

*Specific context to inject into each story draft:*

{{#each stories}}
### {{key}}: {{title}}

**Required Patterns:**
{{#each patterns}}
- {{pattern_id}}: {{pattern_name}}
{{/each}}

**Architecture Dependencies:**
{{#each arch_deps}}
- {{section}}: {{relevance}}
{{/each}}

**State File Learnings:**
{{#if has_state_learnings}}
{{#each state_learnings}}
- {{description}}
{{/each}}
{{else}}
*No state file learnings specific to this story.*
{{/if}}

**Predecessor Learnings:**
{{#if has_predecessors}}
{{#each predecessor_learnings}}
- From {{source_story}}: {{learning}}
{{/each}}
{{else}}
*No predecessor stories in earlier batches.*
{{/if}}

**Relevant Action Items:**
{{#each action_items}}
- {{id}}: {{action}}
{{/each}}

**Special Notes:**
{{special_notes}}

---

{{/each}}

## Technical Debt Context

*Known technical debt that may affect this epic:*

{{#each technical_debt}}
- **{{id}}:** {{description}}
  - Source: Epic {{source_epic}}
  - Severity: {{severity}}
  - Stories affected: {{affected_stories}}
{{/each}}

{{#if no_debt}}
*No known technical debt affecting this epic.*
{{/if}}

---

## Checklist for Story Drafting

When creating story drafts for {{epic_key}}, ensure:

- [ ] All required patterns from this briefing are referenced in Dev Notes
- [ ] Architecture dependencies are cited with section references
- [ ] Relevant action items are addressed or acknowledged
- [ ] State file learning records are incorporated
- [ ] Predecessor learnings are incorporated (for Batch 2+ stories)
- [ ] Technical debt items are considered in task breakdown
- [ ] Story follows established naming conventions

---

*This briefing was auto-generated by the create-epic workflow v2.0.*
*Source retrospectives: {{retro_sources}}*
*Source state files: {{state_file_sources}}*
*Generated by: {{agent_name}}*
